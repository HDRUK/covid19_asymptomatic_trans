#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
here::here()
model
model_beta_bar_only <- fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
model_beta_bar_only
model_beta_bar_only_sample = rbi::sample(one_param_model, target = "posterior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
model_beta_bar_only_sample = rbi::sample(model_beta_bar_only, target = "posterior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
library('coda')
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
# init <- list(S = 3710.0,
#              E = 0,
#              I_a = 0,
#              I_p = 0,
#              I_su = 0,
#              I_sk = 1,
#              C = 0,
#              R_s = 0,
#              R_n = 0,
#              Z_sk = 0,
#              Z_n = 0,
#              delta_I_a = 0,
#              delta_I_a = 0,
#              N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
model_prime <- fix(model, chi = 0, theta_a = 0)
model_sample = rbi::sample(model_prime, target = "posterior", nsamples = 1000,
obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
adapted <- model_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
posterior <- adapted %>%
sample(nsamples = 100000)
plot(mcmc(get_traces(posterior), thin = 10))
summary(posterior)
summary(posterior,type="state")
trajectories = summary(posterior,type="state")
plot(trajectories$time,trajectories$Median)
trajectories$Median
trajectories = subset(trajectories, var == Z_sk)
trajectories = subset(trajectories, var == S)
trajectories = summary(posterior,type="state")
trajectories = subset(trajectories, var == S)
subset(trajectories, var == S)
trajectories = subset(trajectories, var == "Z_sk")
plot(trajectories$time,trajectories$Median)
plot(trajectories$time,trajectories$Median)
plot(data_cases_symp)
plot(trajectories$time,trajectories$Median)
plot(data_cases_symp)
lines(trajectories$time,trajectories$Median)
lines(trajectories)
lines(trajectories$time,trajectories$Median)
plot(data_cases_symp)
lines(trajectories$time,trajectories$`1st Qu.`)
lines(trajectories$time,trajectories$Median)
lines(trajectories$time,trajectories$`3rd Qu.`)
trajectories = subset(trajectories, var == "Z_n")
plot(data_cases_non_symp)
lines(trajectories$time,trajectories$`1st Qu.`)
lines(trajectories$time,trajectories$Median)
lines(trajectories$time,trajectories$`3rd Qu.`)
trajectories = summary(posterior,type="state")
trajectories = subset(trajectories, var == "Z_n")
plot(data_cases_non_symp)
lines(trajectories$time,trajectories$`1st Qu.`)
lines(trajectories$time,trajectories$Median)
lines(trajectories$time,trajectories$`3rd Qu.`)
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
library('coda')
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
# init <- list(S = 3710.0,
#              E = 0,
#              I_a = 0,
#              I_p = 0,
#              I_su = 0,
#              I_sk = 1,
#              C = 0,
#              R_s = 0,
#              R_n = 0,
#              Z_sk = 0,
#              Z_n = 0,
#              delta_I_a = 0,
#              delta_I_a = 0,
#              N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
#model_prime <- fix(model)
model_sample = rbi::sample(model, target = "posterior", nsamples = 1000,
obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
library('coda')
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
# init <- list(S = 3710.0,
#              E = 0,
#              I_a = 0,
#              I_p = 0,
#              I_su = 0,
#              I_sk = 1,
#              C = 0,
#              R_s = 0,
#              R_n = 0,
#              Z_sk = 0,
#              Z_n = 0,
#              delta_I_a = 0,
#              delta_I_a = 0,
#              N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
#model_prime <- fix(model)
model_sample = rbi::sample(model, target = "posterior", nsamples = 1000,
obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
adapted <- model_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
posterior <- adapted %>%
sample(nsamples = 10000)
plot(mcmc(get_traces(posterior), thin = 10))
results = bi_read(posterior)
summary(posterior)
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
library('coda')
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
# init <- list(S = 3710.0,
#              E = 0,
#              I_a = 0,
#              I_p = 0,
#              I_su = 0,
#              I_sk = 1,
#              C = 0,
#              R_s = 0,
#              R_n = 0,
#              Z_sk = 0,
#              Z_n = 0,
#              delta_I_a = 0,
#              delta_I_a = 0,
#              N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
#model_prime <- fix(model)
model_sample = rbi::sample(model, target = "posterior", nsamples = 10000,
obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
adapted <- model_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
posterior <- adapted %>%
sample(nsamples = 100000)
save_libbi(posterior, here::here("results", "posterior.rds"))
plot(mcmc(get_traces(posterior), thin = 100))
plot(mcmc(get_traces(posterior), thin = 100))
plot(mcmc(get_traces(posterior), thin = 100))
plot(mcmc(get_traces(posterior), thin = 100))
plot(mcmc(get_traces(posterior), thin = 1000))
plot(mcmc(traces)
plot(mcmc(traces)
plot(mcmc(traces))
traces = get_traces(posterior, thin = 100)
plot(mcmc(traces))
summary(posterior)
summary(posterior, type = "state")
trajectories = summary(posterior, type = "state")
symp_traj = subset(trajectories, var == "Z_sk")
symp_traj
non_symp_traj = subset(trajectories, var == "Z_n")
non_symp_traj
plot(data_cases_symp)
lines(symp_traj$time,symp_traj$`1st Qu.`)
lines(symp_traj$time,symp_traj$Median)
lines(symp_traj$time,symp_traj$`3rd Qu.`)
trajectories = summary(posterior, type = "state")
symp_traj = subset(trajectories, var == "Z_sk")
non_symp_traj = subset(trajectories, var == "Z_n")
plot(data_cases_symp)
lines(symp_traj$time,symp_traj$`1st Qu.`)
lines(symp_traj$time,symp_traj$Median)
lines(symp_traj$time,symp_traj$`3rd Qu.`)
plot(data_cases_non_symp)
lines(non_symp_traj$time,symp_traj$`1st Qu.`)
lines(non_symp_traj$time,symp_traj$Median)
lines(non_symp_traj$time,symp_traj$`3rd Qu.`)
plot(data_cases_symp)
lines(symp_traj$time,symp_traj$`1st Qu.`)
lines(symp_traj$time,symp_traj$Median)
lines(symp_traj$time,symp_traj$`3rd Qu.`)
plot(data_cases_non_symp)
lines(non_symp_traj$time,non_symp_traj$`1st Qu.`)
lines(non_symp_traj$time,non_symp_traj$Median)
lines(non_symp_traj$time,non_symp_traj$`3rd Qu.`)
plot(data_cases_non_symp)
lines(non_symp_traj$time,non_symp_traj$Min)
lines(non_symp_traj$time,non_symp_traj$Median)
lines(non_symp_traj$time,non_symp_traj$Max)
plot(data_cases_non_symp)
lines(non_symp_traj$time,non_symp_traj$Min)
#lines(non_symp_traj$time,non_symp_traj$Median)
lines(non_symp_traj$time,non_symp_traj$Max)
plot(data_cases_symp)
lines(symp_traj$time,symp_traj$Min)
#lines(symp_traj$time,symp_traj$Median)
lines(symp_traj$time,symp_traj$Max)
pred <- predict(posterior, start_time=0, end_time=32, output_every=1, nsamples = 10000)
pred = summary(posterior, type = "state")
symp_traj = subset(pred, var == "Z_sk")
non_symp_traj = subset(pred, var == "Z_n")
plot(data_cases_symp)
lines(symp_traj$time,symp_traj$Min)
#lines(symp_traj$time,symp_traj$Median)
lines(symp_traj$time,symp_traj$Max)
plot(data_cases_symp)
lines(symp_traj$time,symp_traj$Min)
#lines(symp_traj$time,symp_traj$Median)
lines(symp_traj$time,symp_traj$Max)
plot(data_cases_non_symp)
lines(non_symp_traj$time,non_symp_traj$Min)
#lines(non_symp_traj$time,non_symp_traj$Median)
lines(non_symp_traj$time,non_symp_traj$Max)
traces = get_traces(posterior, thin = 100)
pairs(traces)
plot(mcmc(traces))
pairs(mcmc(traces))
traces = get_traces(posterior, thin = 1000)
pairs(mcmc(traces))
warnings()
pairs(mcmc(traces))
pairs(mcmc(traces))
pairs(traces)
plot(mcmc(traces))
