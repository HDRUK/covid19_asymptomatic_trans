plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
title_size = 18
ggplot(subset(trajectories_obs, var == "Z_sk"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40), expand = c(0, 0)) +
labs(title = "Symptomatic cases",
x = "Onset date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(subset(trajectories_obs, var == "Z_n"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_non_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100), expand = c(0, 0)) +
labs(title = "Non-symptomatic cases",
x = "Test date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
axis_title_size = 16
ggplot(subset(trajectories_obs, var == "Z_sk"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40), expand = c(0, 0)) +
labs(title = "Symptomatic cases",
x = "Onset date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(subset(trajectories_obs, var == "Z_n"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_non_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100), expand = c(0, 0)) +
labs(title = "Non-symptomatic cases",
x = "Test date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(subset(trajectories_obs, var == "Z_sk"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40), expand = c(0, 0)) +
labs(title = "Symptomatic cases",
x = "Onset date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(subset(trajectories_obs, var == "Z_n"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_non_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100), expand = c(0, 0)) +
labs(title = "Non-symptomatic cases",
x = "Test date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
data_tests
View(data_tests)
ggplot(data_tests, aes(x=time)) +
geom_point(aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 50), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(data_tests, aes(x=time)) +
geom_bar(aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 50), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(data_tests, aes(x=time)) +
geom_bar(aes(y = value), colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 50), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
ggplot(data_tests, aes(x=time)) +
geom_bar(stat="identity", aes(y = value), colour = "white", fill = "#24478f") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 50), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
g = ggplot(subset(trajectories_obs, var == "Z_sk"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40), expand = c(0, 0)) +
labs(title = "Symptomatic cases",
x = "Onset date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
h = ggplot(subset(trajectories_obs, var == "Z_n"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_non_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100), expand = c(0, 0)) +
labs(title = "Non-symptomatic cases",
x = "Test date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
i = ggplot(data_tests, aes(x=time)) +
geom_bar(stat="identity", aes(y = value), colour = "white", fill = "#24478f") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 50), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
plot = (g|h)/(i) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
library("patchwork", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
plot = (g|h)/(i) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
plot = (g|h)/(i|) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
plot = (g/i|h) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
plot = (g|h)|(i|) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
plot = (g|h)/
i #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
plot = (g|h)/(i|i) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
ggsave(plot, file = here::here("plots", paste0(scenario,"fitting.png")), width = aspect_ratio*height, height = height, units = "cm", dpi = 300)
ggsave(plot, file = here::here("plots", paste0(scenario,"_fitting.png")), width = aspect_ratio*height, height = height, units = "cm", dpi = 300)
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*height, height = height, units = "cm", dpi = 300)
height = 2*16
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*height, height = height, units = "cm", dpi = 300)
patches_height = 1.5*16
height = 16
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
patches_height = 1.6*16
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
i = ggplot(data_tests, aes(x=time)) +
geom_bar(stat="identity", aes(y = value), colour = "white", fill = "#24478f") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 100), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
plot = (g|h)/(i|i) #+ plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
plot = (g|h)/(i|i) plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot = (g|h)/(i|i) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 24), plot.tag.position = c(0.03,0.965))
plot
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
plot = (g|h)/(i|i) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 16), plot.tag.position = c(0.03,0.965))
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
plot = (g|h)/(i|i) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 16), plot.tag.position = c(0.03,0.9))
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
plot = (g|h)/(i|i) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 16), plot.tag.position = c(0.03,0.95))
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
plot = (g|h)/(i|i) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 16), plot.tag.position = c(0.03,0.94))
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
plot = (g|h)/(i|i) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 16), plot.tag.position = c(0.03,0.945))
ggsave(plot, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
dates <-
readr::read_csv(file = here::here("data", "dates_day_no_conv.csv")) %>%
dplyr::select(dates = test_date)
dates <-
readr::read_csv(file = here::here("data", "dates_day_no_conv.csv")) %>%
dplyr::select(dates = date)
dates
g = ggplot(subset(trajectories_obs, var == "Z_sk"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40), expand = c(0, 0)) +
labs(title = "Symptomatic cases",
x = "Onset date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
g
symp = ggplot(subset(trajectories_obs, var == "Z_sk"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 40, 5), limits = c(0, 40), expand = c(0, 0)) +
labs(title = "Symptomatic cases",
x = "Onset date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
non_symp = ggplot(subset(trajectories_obs, var == "Z_n"), aes(x=time)) +
geom_line(aes(y = Median), size = line_thickness, na.rm=TRUE, colour = colour_line) +
geom_ribbon(aes(ymin=`2.5%`, ymax= `97.5%`), fill = colour_line, alpha=alpha) +
geom_point(data = data_cases_non_symp, aes(y = value), size = point_size, colour = "black") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 100, 10), limits = c(0, 100), expand = c(0, 0)) +
labs(title = "Non-symptomatic cases",
x = "Test date",
y = "Number of cases") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
tests = ggplot(data_tests, aes(x=time)) +
geom_bar(stat="identity", aes(y = value), colour = "white", fill = "#24478f") +
scale_x_continuous(breaks = seq(0, 32, 1), limits = c(0, 32.5), expand = c(0, 0), labels = dates$dates) +
scale_y_continuous(breaks = seq(0, 700, 100), limits = c(0, 700), expand = c(0, 0)) +
labs(title = "Symptom agnostic tests",
x = "Test date",
y = "Number of tests") +
theme(text = element_text(family = "sans"),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank(),
axis.line = element_line(),
axis.line.x.bottom = element_line(size = line_thickness),
axis.line.y.left = element_line(size = line_thickness),
axis.ticks = element_line(size = line_thickness),
#strip.background = element_rect(fill = "white"),
#strip.text = element_text(face = "bold", size = 0),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 20), size = axis_title_size),
axis.title.y.left = element_text(vjust= 3, margin = margin(l = 15), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.3, hjust = 0,size = x_axis_text_size, angle = 90),
axis.text.y.left = element_text(size = y_axis_text_size),
plot.title = element_text(size = title_size, vjust = 3, hjust = title_align, margin = margin(t = 20), face = title_face)) +
#scale_colour_manual(name = NULL, values = c(colour_no_self_cure,colour_line), labels = c("No self-cure", "Self-cure")) +
theme(legend.position = "none")
fitting = (non_symp|symp)/(tests|tests) + plot_annotation(tag_levels = 'A') & theme(plot.tag = element_text(size = 16), plot.tag.position = c(0.03,0.945))
ggsave(fitting, file = here::here("plots","primary", paste0(scenario,"_fitting.png")), width = aspect_ratio*patches_height, height = patches_height, units = "cm", dpi = 300)
