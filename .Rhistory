points(data_cases_non_symp$time,data_cases_non_symp$dR_n)
plot(traj(params_ls_2)[,"time"],traj(params_ls_2)[,"dI_sk"],type="l",xlab="Days",ylab="Number of cases",main="Symptomatic cases by onset date", ylim = c(0,25))
points(data_cases_symp$time,data_cases_symp$dI_sk)
plot(traj(params_ls_2)[,"time"],traj(params_ls_2)[,"dI_sk"],type="l",xlab="Days",ylab="Number of cases",main="Symptomatic cases by onset date", ylim = c(0,25))
points(data_cases_symp$time,data_cases_symp$dI_sk)
plot(traj(params_ls_2)[,"time"],traj(params_ls_2)[,"dR_n"],type="l",xlab="Days",ylab="Number of cases",main="Non-symptomatic cases by test date",plot(traj(params_ls)[,"time"],traj(params_ls)[,"dI_sk"],type="l",xlab="Days",ylab="Number of cases",main="Symptomatic cases by onset date"), ylim = c(0,80))
points(data_cases_non_symp$time,data_cases_non_symp$dR_n)
data_non_symp = read.csv(file = "raw_data_non_symp_mizumoto_20.csv", header = TRUE, sep = ",") # raw data
data_non_symp
data_non_symp
data_non_symp$tests_non_symp = data_non_symp$tests - data_non_symp$symp                        # number of tests performed on everyone except symptomatics
data_non_symp
data_non_symp$day_no = seq(1,length(data_symp$onset_date),1)                                   # add in day numbers (day 1 = Jan 20th)
data_non_symp$day_no = seq(1,length(data_symp$onset_date),1)                                   # add in day numbers (day 1 = Jan 20th)
data_non_symp$day_no = seq(1,length(data_non_symp$onset_date),1)                                   # add in day numbers (day 1 = Jan 20th)
data_non_symp$day_no = seq(1,length(data_non_symp$test_date),1)                                   # add in day numbers (day 1 = Jan 20th)
data_non_symp
data_non_symp$tests_non_symp_cum = cumsum(data_non_symp$tests_non_symp)                        # cumulatiec number of tests performed on everyone except symptomatics
data_non_symp
data_tests = data_non_symp[,c("test_date","day_no","tests_non_symp_cum")]    # Cumulative PCR tests as input for PCR screening function in the model
data_tests
data_cases_non_symp = data_non_symp[,c("test_date","day_no","non_symp")]     # Incident non-symptomatic cases by date of PCR test for model fitting
data_cases_non_symp
data_non_symp = read.csv(file = "raw_data_non_symp_mizumoto_20.csv", header = TRUE, sep = ",") # raw data
data_non_symp$tests_non_symp = data_non_symp$tests - data_non_symp$symp                        # number of tests performed on everyone except symptomatics
data_non_symp$day_no = seq(1,length(data_symp$onset_date),1)                                   # add in day numbers (day 1 = Jan 20th)
data_non_symp$tests_non_symp_cum = cumsum(data_non_symp$tests_non_symp)                        # cumulatiec number of tests performed on everyone except symptomatics
data_tests = data_non_symp[,c("test_date","day_no","tests_non_symp_cum")]    # Cumulative PCR tests as input for PCR screening function in the model
data_symp = read.csv(file = "raw_data_symp_nishiura_20.csv", header = TRUE, sep = ",")    # raw data
data_symp$all = rowSums(data_symp[,c(-1)])                                                # aggregation into total cases
data_symp$day_no = seq(1,length(data_symp$onset_date),1)                                  # add in day numbers (day 1 = Jan 20th)
data_cases_symp = data_symp[,c("onset_date","day_no","all")]     # Incident symptomatic cases by onset date for model fitting
write.csv(data_cases_symp, file = "data_cases_symp.csv", row.names = FALSE)
setwd("/Users/jonemery/Google Drive/LSHTM - Research Fellow/03 R/Working directory")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
data_symp = read.csv(file = "raw_data_symp_nishiura_20.csv", header = TRUE, sep = ",")    # raw data
data_symp$all = rowSums(data_symp[,c(-1)])                                                # aggregation into total cases
setwd("/Users/jonemery/Google Drive/LSHTM - Research Fellow/03 R/Working directory")
library("ggplot2", lib.loc="/Library/Frameworks/R.framework/Versions/3.5/Resources/library")
data_symp = read.csv(file = "raw_data_symp_nishiura_20.csv", header = TRUE, sep = ",")    # raw data
data_symp$all = rowSums(data_symp[,c(-1)])                                                # aggregation into total cases
data_symp$day_no = seq(1,length(data_symp$onset_date),1)                                  # add in day numbers (day 1 = Jan 20th)
data_cases_symp = data_symp[,c("onset_date","day_no","all")]     # Incident symptomatic cases by onset date for model fitting
write.csv(data_cases_symp, file = "data_cases_symp.csv", row.names = FALSE)
data_non_symp = read.csv(file = "raw_data_non_symp_mizumoto_20.csv", header = TRUE, sep = ",") # raw data
data_non_symp$tests_non_symp = data_non_symp$tests - data_non_symp$symp                        # number of tests performed on everyone except symptomatics
data_non_symp$day_no = seq(1,length(data_symp$onset_date),1)                                   # add in day numbers (day 1 = Jan 20th)
data_non_symp$tests_non_symp_cum = cumsum(data_non_symp$tests_non_symp)                        # cumulatiec number of tests performed on everyone except symptomatics
data_tests = data_non_symp[,c("test_date","day_no","tests_non_symp_cum")]    # Cumulative PCR tests as input for PCR screening function in the model
write.csv(data_tests, file = "data_tests.csv", row.names = FALSE)
data_cases_non_symp = data_non_symp[,c("test_date","day_no","non_symp")]     # Incident non-symptomatic cases by date of PCR test for model fitting
write.csv(data_cases_non_symp, file = "data_cases_non_symp.csv", row.names = FALSE)
data_tests
data_non_symp
data_non_symp
ggplot() +
geom_bar(data = data_non_symp, stat="identity", aes(x = day_no, y = tests_non_symp), colour = "white", fill = "#24478f") +
scale_x_continuous(labels = data_non_symp$test_date, breaks = data_non_symp$day_no, expand = c(0, 0)) +
scale_y_continuous(breaks = seq(0,700,50), limits = c(0,700), expand = c(0,0)) +
labs(title = "Cumulative tests (excluding symptomatics) by test date",
x = "Date of test",
y = "Cumulative number of tests") +
theme(text = element_text(family = "sans"),
plot.title = element_text(size = title_size, vjust = 8, hjust = 0.5, margin = margin(t = 30), face = title_face),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 18), size = axis_title_size),
axis.title.y.left = element_text(vjust = 4, margin = margin(l = 28), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.5, size = x_axis_text_size, angle = 90, margin = margin(t = 6)),
axis.text.y.left = element_text(size = y_axis_text_size),
axis.line.x.bottom = element_line(size = axis_line_thickness),
axis.line.y.left = element_line(size = axis_line_thickness),
axis.ticks = element_line(size = axis_line_thickness),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank())
height = 16
aspect_ratio = 1.4
title_size = 18
title_face = "bold"
axis_title_size = 16
x_axis_text_size = 10
y_axis_text_size = 13
axis_line_thickness = 1.1
ggplot() +
geom_bar(data = data_non_symp, stat="identity", aes(x = day_no, y = tests_non_symp), colour = "white", fill = "#24478f") +
scale_x_continuous(labels = data_non_symp$test_date, breaks = data_non_symp$day_no, expand = c(0, 0)) +
scale_y_continuous(breaks = seq(0,700,50), limits = c(0,700), expand = c(0,0)) +
labs(title = "Cumulative tests (excluding symptomatics) by test date",
x = "Date of test",
y = "Cumulative number of tests") +
theme(text = element_text(family = "sans"),
plot.title = element_text(size = title_size, vjust = 8, hjust = 0.5, margin = margin(t = 30), face = title_face),
axis.title.x.bottom = element_text(vjust = -2, margin = margin(b = 18), size = axis_title_size),
axis.title.y.left = element_text(vjust = 4, margin = margin(l = 28), size = axis_title_size),
axis.text.x.bottom = element_text(vjust = 0.5, size = x_axis_text_size, angle = 90, margin = margin(t = 6)),
axis.text.y.left = element_text(size = y_axis_text_size),
axis.line.x.bottom = element_line(size = axis_line_thickness),
axis.line.y.left = element_line(size = axis_line_thickness),
axis.ticks = element_line(size = axis_line_thickness),
panel.background = element_blank(),
panel.grid.major.y = element_blank(),
panel.grid.major.x = element_blank())
source('~/Google Drive/LSHTM - Research Fellow/03 R/Working directory/data_prep_and_plots.R', echo=TRUE)
source('~/Google Drive/LSHTM - Research Fellow/03 R/Working directory/data_prep_and_plots.R', echo=TRUE)
?dgamma
scale = function(mean,shape){
scale = mean/shape
return(scale)
}
scale(4,5)
lat = c(shape=5,scale=scale(4,5))
lat
shape_scale = function(mu,k){
shape_scale = c(shape = k, scale = mu/shape)
return(shape_scale)
}
shape_scale(4,5)
shape_scale = function(mu,k){
shape_scale = c("shape" = k, "scale" = mu/shape)
return(shape_scale)
}
shape_scale(4,5)
shape_scale = function(mu,k){
shape_scale = c(shape = k, scale = mu/k)
return(shape_scale)
}
shape_scale(4,5)
lat = c(shape_scale(4,5))
pgamma(1,lat)
dgamma(1,lat)
dgamma(1,4,5)
lat = c(shape_scale(4,5))
lat
dgamma(c(1,4,5))
dist = function(mu,k){
dist = dgamma(1,shape = k, scale = mu/k)
return(dist)
}
gamma = function(mu,k){
dist = dgamma(1,shape = k, scale = mu/k)
return(dist)
}
gamma(4,5)
gamma = function(mu,k,t_max){
dist = dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k)
return(dist)
}
gamma(4,5,10)
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k))
return(plot)
}
gamma(4,5,10)
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
return(plot)
}
gamma(4,5,10)
lat = gamma(4,5,10)
lat
lat = gamma(4,5,10)
lat
gamma(4,5,10)
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
return(plot)
}
gamma(4,5,10)
gamma(4,5,10)
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
return(plot)
}
gamma(4,5,10)
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
return(plot)
}
gamma(4,5,10)
gamma(4,5,10)
nu_1 = gamma(4,5,10)
t_max = 10
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
return(plot)
}
gamma_p_1 = gamma(2.4,5,t_max)
gamma_a_1 = gamma(7,5,t_max)
t_max = 10
nu_1 = gamma(4,5,t_max)
t_max = 15
nu_1 = gamma(4,5,t_max)
t_max = 14
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.1),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
return(plot)
}
nu_1 = gamma(4,5,t_max)
gamma_p_1 = gamma(2.4,5,t_max)
gamma_s_1 = gamma(3.2,3.7)
nu_1 = gamma(4,5,t_max)
gamma_p_1 = gamma(2.4,5,t_max)
gamma_s_1 = gamma(3.2,3.7,t_max)
gamma_a_1 = gamma(7,5,t_max)
plot(3.2,3.7,t_max)
gamma(3.2,3.7,t_max)
gamma(3.2,1,t_max)
gamma(3.2,2,t_max)
gamma(3.2,3,t_max)
gamma(3.2,5,t_max)
gamma(3.2,8,t_max)
gamma(3.2,9,t_max)
gamma(3.2,20,t_max)
gamma(3.2,50,t_max)
gamma(3.2,100,t_max)
t_max = 5
gamma(2.5,100,t_max)
plot = plot(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.1),shape = k, scale = mu/k),type="l")
plot = plot(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.01),shape = k, scale = mu/k),type="l")
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.01),shape = k, scale = mu/k),type="l")
return(plot)
}
gamma(2.5,100,t_max)
gamma(2,100,t_max)
gamma(3.2,100,t_max)
gamma(3.2,1000,t_max)
gamma(3.2,3.7,t_max)
t_max = 14
gamma(3.2,3.7,t_max)
nu_1 = gamma(4,5,t_max)
gamma_p_1 = gamma(2.4,5,t_max)
gamma_s_1 = gamma(3.2,3.7,t_max)
nu_1 = gamma(4,5,t_max)
gamma_p_1 = gamma(2.4,5,t_max)
gamma_s_1 = gamma(3.2,3.7,t_max)
gamma_a_1 = gamma(7,5,t_max)
2.4/5
3.2/3.7
5+3.7
?gamma
?pgamma
rgamma(5,0.48)
rgamma(5,0.48)
rgamma(5,0.48)
rgamma(1,0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(1,shape=5,scale=0.48)+rgamma(1,shape=3.7,scale=0.865)
rgamma(10000,shape=5,scale=0.48)+rgamma(10000,shape=3.7,scale=0.865)
hist(rgamma(10000,shape=5,scale=0.48)+rgamma(10000,shape=3.7,scale=0.865))
hist(rgamma(10000,shape=5,scale=0.48)+rgamma(10000,shape=3.7,scale=0.865))
hist(rgamma(10000,shape=5,scale=0.48)+rgamma(10000,shape=3.7,scale=0.865))
hist(rgamma(100000,shape=5,scale=0.48)+rgamma(100000,shape=3.7,scale=0.865))
hist(rgamma(100000,shape=5,scale=0.48)+rgamma(100000,shape=3.7,scale=0.865))
hist(rgamma(100000,shape=5,scale=0.48)+rgamma(100000,shape=3.7,scale=0.865))
hist(rgamma(100000,shape=5,scale=0.48)+rgamma(100000,shape=3.7,scale=0.865))
hist(rgamma(100000,shape=5,scale=0.48)+rgamma(100000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
7/5
rgamma(1000000,shape=5,scale=1.4)
hist(rgamma(1000000,shape=5,scale=1.4))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=1.4))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=1.4))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=1.4))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
hist(rgamma(1000000,shape=5,scale=1.4))
hist(rgamma(1000000,shape=5,scale=0.48)+rgamma(1000000,shape=3.7,scale=0.865))
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.01),1/dgamma(seq(0,t_max,0.01),shape = k, scale = mu/k),type="l")
return(plot)
}
nu_1 = gamma(4,5,t_max)
t_max = 1
nu_1 = gamma(4,5,t_max)
t_max = 0.1
nu_1 = gamma(4,5,t_max)
plot = plot(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.01),shape = k, scale = mu/k),type="l")
t_max = 14
nu_1 = gamma(4,5,t_max)
gamma = function(mu,k,t_max){
plot = plot(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.01),shape = k, scale = mu/k),type="l")
return(plot)
}
t_max = 14
nu_1 = gamma(4,5,t_max)
gamma_p_1 = gamma(2.4,5,t_max)
gamma_s_1 = gamma(3.2,3.7,t_max)
gamma_a_1 = gamma(7,5,t_max)
gamma_s_1 = gamma(3.2,3.7,t_max)
lines(seq(0,t_max,0.01),derlang(seq(0,t_max,0.01),2.9,2))
lines(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.01),2.9,2))
gamma_s_1 = gamma(3.2,3.7,t_max)
lines(seq(0,t_max,0.01),dgamma(seq(0,t_max,0.01),2.9,2))
beta=function(t){
beta = beta_bar*exp(-b_1*(t-t_mu))
}
beta(0)
beta_bar = 1.07
b_1 = 1.40
t_mu = 16
beta=function(t){
beta = beta_bar*exp(-b_1*(t-t_mu))
}
beta(0)
beta(0)
beta=function(t){
beta = beta_bar*exp(-b_1*(t-t_mu))
return(beta)
}
beta(0)
beta(c(0,1))
times = seq(0,32,0.1)
plot(times,beta(times))
plot(times,beta(times),type="l")
times = seq(t_mu,32,0.1)
plot(times,beta(times),type="l")
beta(t_mu)
times = seq(t_mu,32,1)
beta(times)
beta(times)
beta_bar = 0.60408964
beta_bar = 1.01270886
b_1 = 0.60408964
t_mu = 16
beta=function(t){
beta = beta_bar*exp(-b_1*(t-t_mu))
return(beta)
}
times = seq(t_mu,32,1)
plot(times,beta(times),type="l")
source('~/.active-rstudio-document', echo=TRUE)
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_troubleshoot.bi"))
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
here
here::here()
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
