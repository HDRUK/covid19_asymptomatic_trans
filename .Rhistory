E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
good_params_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
good_params_model
good_params_sample = rbi::sample(good_params_model, target = "posterior", proposal = "prior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
x = bi_read(good_params_sample)
x$loglikelihood
x$logprior
y = get_traces(good_params_sample)
y
bad_traj = extract_sample(good_params_sample,1)
plot(bad_traj$Z_sk,type="l")
points(data_cases_symp)
bad_traj$Z_sk[2]
as.data.frame(data_cases_symp)[2]
sum(log(dpois(as.data.frame(data_cases_non_symp)[[2]],bad_traj$Z_n[[2]])))
sum(log(dpois(as.data.frame(data_cases_symp)[[2]],bad_traj$Z_sk[[2]])))
x$loglikelihood
plot(good_params_traj$Z_sk,type="l")
points(data_cases_symp)
good_params_traj = bi_read(good_params_sample, type = "state")
plot(good_params_traj$Z_sk,type="l")
points(data_cases_symp)
good_params_traj
x$loglikelihood
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
good_params_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
good_params_sample = rbi::sample(good_params_model, target = "posterior", proposal = "prior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
x = bi_read(good_params_sample)
x$loglikelihood
y = get_traces(good_params_sample)
y
rbi::sample(good_params_model, target="prior", nsamples=1000, end_time=32, noutputs=32)
prior_sample = rbi::sample(good_params_model, target = "prior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
prior_sample
x = bi_read(prior_sample)
x$loglikelihood
z$prior
x$prior
x$logprior
x$logprior
x = bi_read(prior_sample)
y = get_traces(prior_sample)
y
prior_sample = rbi::sample(good_params_model, target = "prior", nsamples = 1000,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
y = get_traces(prior_sample)
y
x = bi_read(good_params_sample)
x$S
x = bi_read(good_params_sample)
x$loglikelihood
y = get_traces(prior_sample)
y$beta_bar
x = bi_read(prior_sample)
x$beta_bar
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
good_params_sample = rbi::sample(good_params_model, target = "posterior", proposal = "proposal", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
model
good_params_model
good_params_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
good_params_model
good_params_sample = rbi::sample(good_params_model, target = "posterior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
good_params_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
good_params_model
good_params_sample = rbi::sample(good_params_model, target = "posterior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
good_params_model
good_params_sample = rbi::sample(good_params_model, target = "posterior", nsamples = 1000,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
adapted <- good_params_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
adapted <- initial_fit %>%
adapt_proposal(min = 0.2, max = 0.3)
adapted <- good_params_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
?adapt_proposal
adapted <- good_params_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
good_params_sample
adapted <- good_params_sample %>%
adapt_proposal(min = 0.2, max = 0.3)
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
model
initial_fit <- rbi::sample(model, target = "posterior", proposal = "proposal", nsamples = 1000,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
initial_fit <- rbi::sample(model, target = "posterior", nsamples = 1000,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
initial_fit <- rbi::sample(model, target = "posterior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
adapted <- initial_fit %>%
adapt_proposal(min = 0.2, max = 0.3)
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
one_param_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
one_param_model
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
one_param_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
one_param_model
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
one_param_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
one_param_model_sample = rbi::sample(one_param_model, target = "posterior", nsamples = 1000,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
one_param_model
one_param_model
one_param_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
one_param_model_sample = rbi::sample(one_param_model, target = "posterior", nsamples = 100,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
bi_contents(one_param_model_sample)
contents = bi_contents(one_param_model_sample)
contents
contents = bi_contents(one_param_model_sample)
bi_read(one_param_model_sample)
one_param_model_results = bi_read(one_param_model_sample)
one_param_model_results
one_param_model_results$loglikelihood
one_param_model_results$logprior
one_param_model_results$N_tests
one_param_model_results$beta_bar
rewrite(model)
rewrite(one_param_model)
setwd("~/Google Drive/LSHTM - Research Fellow/03 R/covid19_asymptomatic_trans")
#library('devtools')
#install_github("libbi/rbihelpers")
#library(devtools)
#install_github("sbfnk/rbi.helpers")
library("here")
library("tidyverse")
library("rbi")
library("rbi.helpers")
library("GGally")
here::here()
data_cases_symp <-
readr::read_csv(file = here::here("data", "data_cases_symp.csv")) %>%
dplyr::mutate(date = onset_date, T = day_no, I_sk = all) %>%
dplyr::select(time = T, value = I_sk)
data_cases_non_symp <-
readr::read_csv(file = here::here("data", "data_cases_non_symp.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, R_n = non_symp) %>%
dplyr::select(time = T, value = R_n)
data_tests <-
readr::read_csv(file = here::here("data", "data_tests.csv")) %>%
dplyr::mutate(date = test_date, T = day_no, dN_tests = tests_non_symp) %>%
dplyr::select(time = T, value = dN_tests)
obs <- list(symp = data_cases_symp, non_symp = data_cases_non_symp)
init <- list(S = 3710.0,
E = 0,
I_a = 0,
I_p = 0,
I_su = 0,
I_sk = 1,
C = 0,
R_s = 0,
R_n = 0,
Z_sk = 0,
Z_n = 0,
delta_I_a = 0,
delta_I_a = 0,
N_tests = 0)
input <- list(dN_tests = data_tests)
model <- rbi::bi_model(file = here::here("bi", "asymptomatic_transmission_overhaul.bi"))
one_param_model = fix(model, b_1 = 0.9, b_2 = 1, tau = 18, theta_p = 1, chi = 0, theta_a = 0)
one_param_model_sample = rbi::sample(one_param_model, target = "posterior", nsamples = 100, nparticles = 32,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
one_param_model_sample = rbi::sample(one_param_model, target = "posterior", nsamples = 100, nparticles = 10,
init = init, obs = obs, input = input, end_time = 32, noutputs = 32,
verbose = TRUE)
